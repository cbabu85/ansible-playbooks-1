---
# This role installs icinga2 client for the monitoring nodes.
#
- hosts: all
  roles:
   - role: icinga2/icinga2-ansible-no-ui
     icinga2_conf_global: |
       include "constants.conf"
       include "zones.conf"
       include <itl>
       include <plugins>
       include "features-enabled/*.conf"
       include_recursive "conf.d"
     check_commands:
       check_nrpe: |
          "-H", "$address$",
              "-c", "$remote_nrpe_command$",
     tags: icinga2-no-ui
  tasks:
    - name: Enable API feature
      become: true
      shell: icinga2 feature enable api
